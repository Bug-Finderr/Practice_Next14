# Enhancing SEO with Metadata API in Next.js

When building web applications, **Search Engine Optimization (SEO)** is crucial for increasing visibility and attracting users. Next.js introduces the **Metadata API**, which allows you to define metadata for each page to ensure accurate and relevant information is displayed when your pages are shared or indexed.

In this post, we'll explore how to leverage the Metadata API to enhance **routing metadata** with the new App Router.

## Understanding Metadata in Next.js

Next.js offers two methods to configure metadata in your `layout.tsx` or `page.tsx` files:

1. **Static Metadata Object**: A simple, predefined metadata object.
2. **Dynamic Metadata**: A function that dynamically generates metadata based on route parameters or external data.

### Important Points to Remember

- Both **layout** and **page** files can export metadata.
- Metadata defined in a **layout** applies to all pages under that layout.
- Metadata defined in a **page** only applies to that specific page.
- If both layout and page metadata are defined, **page metadata** takes precedence for the same properties (e.g., title).
- Metadata is combined and merged from the root layout down to the final page.

Let’s explore both static and dynamic metadata configuration.

## Method 1: Static Metadata Object

A static metadata object can be defined in either a `layout.tsx` or `page.tsx` file. Here's how:

### Example: Static Metadata in `page.tsx`

```tsx
export const metadata = {
  title: "About",
  description: "Learn about Next.js in detail.",
};
```

This `metadata` object sets the **title** and **description** for the About page.

### How Metadata is Combined

- The **root layout** can have its own metadata. For example, a default title and description like:

  ```tsx
  export const metadata = {
    title: "Next.js App",
    description: "Generated by Next.js",
  };
  ```

- When you navigate to `/about`, the metadata from the About page (`page.tsx`) overrides the title from the root layout while the description from the layout is retained.

### Example Result

- On `/`, the title will be "Next.js App".
- On `/about`, the title will be "About - Code Evolution" (overriding the root title), but the description "Generated by Next.js" is inherited from the layout.

## Method 2: Dynamic Metadata

Dynamic metadata is useful when your page’s metadata depends on route parameters, external data, or information that changes dynamically. You can define dynamic metadata using the `generateMetadata` function.

### Example: Dynamic Metadata for Product Pages

Imagine an e-commerce site where each product page needs a unique title. Here’s how you can achieve this:

1. Inside the `products/[productID]` folder, create a `page.tsx` file.
2. Define the `generateMetadata` function to dynamically set the page title based on the `productID`:

   ```tsx
   import { Metadata } from "next";

   type Props = {
     params: {
       productID: string;
     };
   };

   export async function generateMetadata({
     params,
   }: Props): Promise<Metadata> {
     const title = `Product ${params.productID}`;
     return {
       title,
     };
   }
   ```

3. Now, when you visit `/products/1`, the title will be "Product 1", and for `/products/100`, the title will be "Product 100".

### Example: Async Dynamic Metadata

Dynamic metadata can also be asynchronous, allowing you to fetch data from an API:

```tsx
export async function generateMetadata({ params }: Props): Promise<Metadata> {
  const productTitle = await fetchProductTitle(params.productID); // Simulated API call
  return {
    title: `Product ${productTitle}`,
  };
}

async function fetchProductTitle(productID: string): Promise<string> {
  // Simulated async fetch
  return new Promise((resolve) =>
    setTimeout(() => resolve(`iPhone ${productID}`), 100)
  );
}
```

In this example, when you visit `/products/5`, the title will be "Product iPhone 5". For `/products/14`, it will be "Product iPhone 14".

### Important Note

- You cannot export both a static `metadata` object and a `generateMetadata` function from the same route segment.

## Conclusion

Next.js makes it easy to configure both **static** and **dynamic metadata** for your application, allowing you to improve SEO and control how your pages appear when shared or indexed. Whether it's a simple static page or a dynamic product detail page, the Metadata API provides flexibility in how you manage metadata.
